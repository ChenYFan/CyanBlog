import{w as y,o as C,c as N,a as t,d,e as D,h as u,i as v,f as i,b as c,j as S}from"./index-7323e31d.js";import{M as k}from"./CodeEditor-82f9e310.js";import{n as f}from"./notyf-cbf9e3c6.js";import{_ as O}from"./EditableTable-c8c40237.js";import{r as J}from"./reinit-24f7bee3.js";import{_ as B}from"./_plugin-vue_export-helper-c27b6911.js";const M={class:"w-full p-6 mx-auto"},U={class:"flex flex-wrap -mx-3"},j={class:"w-full max-w-full px-3"},A={class:"relative flex flex-col h-full min-w-0 break-words bg-white border-0 shadow-soft-xl rounded-2xl bg-clip-border"},E={class:"flex-auto p-4"},V={class:"mb-4"},$={class:"flex-auto p-4"},I={class:"monacoEditor"},T={class:"flex flex-col pl-0 mb-0 rounded-lg"},p="CDN_Domain",z={__name:"cdnDomainConfig",setup(F){const r=new CacheDB("CyanAcc","CyanAccDB"),l=c("visual"),s=c([]),m=async()=>{await r.write(p,JSON.stringify(s.value)),await J()?f.success("设置已保存并应用"):f.info("设置已保存，但尚未应用")},a=c("");y(s,(o,e)=>{for(var n in o)o[n].match===""&&o.splice(n,1);a.value=JSON.stringify(o,null,4)},{deep:!0}),(async()=>{const o=JSON.parse(await r.read(p)||"{}");Object.keys(o).length!==0?(s.value=o,a.value=JSON.stringify(s.value,null,4)):await r.write(p,JSON.stringify(s.value))})();const b={language:"json",code:a.value},h=S({el:"monaco",options:b}),g=o=>{a.value=o;try{JSON.parse(a.value)}catch{console.log();return}s.value=JSON.parse(a.value)},x=o=>{s.value=o},_={match:{type:"string",description:"匹配规则",width:"20%"},domain:{type:"string",description:"CDN域名",width:"25%"},concat:{type:"json",description:"拼接规则",width:"50%"},weight:{type:"number",description:"权重",width:"5%"}},w=()=>{s.value.push({match:"(prefix1|prefix2)\\.testdomain\\.com",domain:"",concat:{},weight:0})};return(o,e)=>(C(),N("div",M,[t("div",U,[t("div",j,[t("div",A,[e[6]||(e[6]=t("div",{class:"p-4 pb-0 mb-0 bg-white border-b-0 rounded-t-2xl"},[t("h6",{class:"mb-0"},"CDN镜像匹配规则 / CDN Domain Match")],-1)),t("div",E,[e[5]||(e[5]=t("h6",{class:"mt-6 font-bold leading-tight uppercase text-xs text-slate-500"},"选择编辑模式",-1)),t("div",V,[d(t("select",{class:"select-form","onUpdate:modelValue":e[0]||(e[0]=n=>l.value=n)},[...e[3]||(e[3]=[t("option",{value:"visual"},"可视化编辑",-1),t("option",{value:"code"},"JSON数据库编辑",-1)])],512),[[D,l.value]])]),t("div",$,[d(t("div",I,[v(k,{option:h,value:a.value,onUpdateContent:g},null,8,["option","value"])],512),[[u,l.value==="code"]]),d(t("div",null,[t("div",T,[v(O,{data:s.value,keyintro:_,onUpdateContent:x},null,8,["data"])])],512),[[u,l.value==="visual"]]),t("button",{onClick:e[1]||(e[1]=n=>w()),"white-style-btn":"",class:"inline-block w-full px-4 py-3 mb-2 ml-2 text-xs font-bold text-center uppercase align-middle transition-all bg-transparent border border-solid rounded-lg cursor-pointer hover:scale-102 hover:shadow-soft-xs active:opacity-85 leading-pro ease-soft-in tracking-tight-soft shadow-soft-md bg-150 bg-x-25 border-fuchsia-500 bg-none text-fuchsia-500 hover:border-fuchsia-500","data-class":"bg-white"},"新增一行空白数据"),t("button",{onClick:e[2]||(e[2]=n=>m()),type:"button",class:"apply-btn"},"保存"),e[4]||(e[4]=t("p",{style:{"font-size":"11px"}},[i("Tips:"),t("br"),i(" 0.请确保 访问优化 - CDN请求与缓存 - 启用“智能多线程Fetch引擎” 为开启状态。多线程引擎未开启情况下修改镜像源无效。"),t("br"),i(" 1.匹配规则会转化为正则，请注意转义"),t("br"),i(" 2.CyanAcc会根据每次请求的成功与否来给予镜像权重奖励，权重越高的镜像会被越优先命中。"),t("br"),i(" 3.一小部分镜像由于其不稳定性，天生具有较小的权重。"),t("br"),i(" 4.拼接规则中形参类型可任意添加，但要保证同一类型的拼接规则中必须含有相同的形参。"),t("br")],-1))])])])])])]))}},Q=B(z,[["__scopeId","data-v-9ec18d0e"]]);export{Q as default};
