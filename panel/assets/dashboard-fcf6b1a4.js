import{C as B}from"./notyf-b7b7a415.js";import{r as a,w as C,o as r,c as _,a as s,t as c,F as g,b as T,n as S}from"./index-1ef1a27b.js";const h=async(m,n)=>(typeof n>"u"&&(n={}),await fetch("/CyanAcc/api",{method:"POST",body:JSON.stringify({action:m,...n})}).then(i=>i.json()).then(i=>{if(i.status==="OK")return i.data;throw new Error(`Get Error: ${i.message}`)})),A={class:"row"},E={class:"col-xl-3 col-sm-6 mb-xl-0 mb-4"},I={class:"card"},P={class:"card-body p-3"},z={class:"row"},D={class:"col-8"},G={class:"numbers"},N=s("p",{class:"text-sm mb-0 text-capitalize font-weight-bold"},"缓存空间占用",-1),$={class:"col-xl-3 col-sm-6 mb-xl-0 mb-4"},L={class:"card"},M={class:"card-body p-3"},O={class:"row"},V={class:"col-8"},F={class:"numbers"},K=s("p",{class:"text-sm mb-0 text-capitalize font-weight-bold"},"持久任务数量",-1),k={class:"font-weight-bolder mb-0"},j=s("div",{class:"col-4 text-end"},[s("div",{class:"icon icon-shape bg-gradient-primary shadow text-center border-radius-md"},[s("i",{class:"ni ni-world text-lg opacity-10","aria-hidden":"true"})])],-1),J={class:"col-xl-3 col-sm-6 mb-xl-0 mb-4"},Z={class:"card"},H={class:"card-body p-3"},U={class:"row"},Y={class:"col-8"},q={class:"numbers"},Q=s("p",{class:"text-sm mb-0 text-capitalize font-weight-bold"},"当前博客版本更新时间",-1),R={class:"font-weight-bolder mb-0"},W=s("div",{class:"col-4 text-end"},[s("div",{class:"icon icon-shape bg-gradient-primary shadow text-center border-radius-md"},[s("i",{class:"ni ni-paper-diploma text-lg opacity-10","aria-hidden":"true"})])],-1),X={class:"col-xl-3 col-sm-6"},ss={class:"card"},ts={class:"card-body p-3"},es={class:"row"},os={class:"col-8"},cs={class:"numbers"},is=s("p",{class:"text-sm mb-0 text-capitalize font-weight-bold"},"CyanAcc激活时间",-1),ns={class:"font-weight-bolder mb-0"},as=s("div",{class:"col-4 text-end"},[s("div",{class:"icon icon-shape bg-gradient-primary shadow text-center border-radius-md"},[s("i",{class:"ni ni-cart text-lg opacity-10","aria-hidden":"true"})])],-1),ls={class:"row mt-4"},ds={class:"col-lg-12 mb-lg-0 mb-4"},rs={class:"card"},_s=s("div",{class:"card-header pb-0 p-3"},[s("div",{class:"d-flex justify-content-between"},[s("h6",{class:"mb-2"},"持久任务表")])],-1),hs={class:"table-responsive w-full"},ms={class:"table align-items-center w-full"},bs=s("tr",null,[s("td",null,[s("div",{class:"text-center"},[s("p",{class:"text-xs font-weight-bold mb-2"},"简介")])]),s("td",null,[s("div",{class:"text-center"},[s("p",{class:"text-xs font-weight-bold mb-2"},"循环周期")])]),s("td",{class:"align-middle text-sm"},[s("div",{class:"col text-center"},[s("p",{class:"text-xs font-weight-bold mb-2"},"上一次执行")])]),s("td",{class:"align-middle text-sm"},[s("div",{class:"col text-center"},[s("p",{class:"text-xs font-weight-bold mb-2"},"启用状态")])])],-1),vs={class:"text-center"},us={class:"text-sm mb-2"},xs={class:"text-center"},ps={class:"text-sm mb-2"},ws={class:"align-middle text-sm"},gs={class:"col text-center"},fs={class:"text-sm mb-2"},ys={class:"align-middle text-sm"},Bs={class:"col text-center"},Ss={__name:"dashboard",setup(m){const n=t=>{if(typeof t!="number")return t;const o=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];let e=0;for(;t>=1024;)t/=1024,e++;return`${t.toFixed(2)} ${o[e]}`},i=t=>{if(typeof t!="number")return t;const o=["毫秒","秒","分钟","小时","天","年"],e=[1e3,60,60,24,365];let l=0;for(;t>=e[l];)t/=e[l],l++;return`${Math.round(t)} ${o[l]}`},b=a("缓存大小尚在获取..."),d=a([]),v=a(0);C(d,t=>{v.value=t.length});const u=a("1970/1/1 08:00:00"),x=a(0),p=async t=>{const o=await h("GET_CACHE_SIZE",{precise:t});b.value=n(o)},w=async()=>{const t=await h("DUMP_VAR_TASKLIST");d.value=t},f=async()=>{const t=new B("CyanAcc","CyanAccDB"),o=JSON.parse(await t.read("Blog_Fetch_Config")).mirrors;for(const e of o)e.type==="npm"&&(u.value=new Date(Number(e.var.PACKAGE_VERSION.split("-")[1])).toLocaleString())},y=async()=>{const t=await h("GET_INIT_TIME");x.value=t};return(async()=>(await p(!1),await w(),setInterval(async()=>{await w()},1e3*5),await f(),await y()))(),(t,o)=>(r(),_(g,null,[s("div",A,[s("div",E,[s("div",I,[s("div",P,[s("div",z,[s("div",D,[s("div",G,[N,s("h5",{class:"font-weight-bolder mb-0",onClick:o[0]||(o[0]=e=>p(!0))},c(n(b.value)),1)])])])])])]),s("div",$,[s("div",L,[s("div",M,[s("div",O,[s("div",V,[s("div",F,[K,s("h5",k,c(v.value),1)])]),j])])])]),s("div",J,[s("div",Z,[s("div",H,[s("div",U,[s("div",Y,[s("div",q,[Q,s("h5",R,c(u.value),1)])]),W])])])]),s("div",X,[s("div",ss,[s("div",ts,[s("div",es,[s("div",os,[s("div",cs,[is,s("h5",ns,c(new Date(x.value).toLocaleString()),1)])]),as])])])])]),s("div",ls,[s("div",ds,[s("div",rs,[_s,s("div",hs,[s("table",ms,[s("tbody",null,[bs,(r(!0),_(g,null,T(d.value,e=>(r(),_("tr",null,[s("td",null,[s("div",vs,[s("h6",us,c(e.description),1)])]),s("td",null,[s("div",xs,[s("h6",ps,c(i(e.interval)),1)])]),s("td",ws,[s("div",gs,[s("h6",fs,c(new Date(e.lastrun.time).toLocaleString()),1)])]),s("td",ys,[s("div",Bs,[s("h6",{class:S(["text-sm mb-2",e.enable?"text-success":"text-danger"])},c(e.enable?"启用":"禁用"),3)])])]))),256))])])])])])])],64))}};export{Ss as default};
