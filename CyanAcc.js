(()=>{var e={491:e=>{e.exports=function(e,t){this.namespace=e||"CacheDBDefaultNameSpace",this.prefix=t||"CacheDBDefaultPrefix",this.read=async function(e,t){return t=t||{type:"text"},new Promise(((r,i)=>{caches.open(this.namespace).then((i=>{i.match(new Request(`https://${this.prefix}/${encodeURIComponent(e)}`)).then((e=>{switch(t.type){case"json":return void r(e.json());case"arrayBuffer":return void r(e.arrayBuffer());case"blob":return void r(e.blob());default:return void r(e.text())}})).catch((e=>{r(null)}))}))}))},this.write=async function(e,t,r){return r=r||{type:"text"},new Promise(((i,n)=>{caches.open(this.namespace).then((n=>{n.put(new Request(`https://${this.prefix}/${encodeURIComponent(e)}`),new Response(t,{headers:{"Content-Type":(()=>{switch(r.type){case"json":return"application/json";case"arrayBuffer":case"blob":return"application/octet-stream";default:return"text/plain"}})()}})).then(i(!0)).catch((e=>{i(!1)}))}))}))},this.delete=async function(e){return new Promise(((t,r)=>{caches.open(this.namespace).then((r=>{r.delete(new Request(`https://${this.prefix}/${encodeURIComponent(e)}`)).then(t(!0)).catch((e=>{t(!1)}))}))}))}}}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,r),a.exports}(()=>{"use strict";r(491),self.CacheDB=function(e,t,r){this.config=r||{auto:0},this.config.auto=this.config.auto||0,this.namespace=e||"CacheDBDefaultNameSpace",this.prefix=t||"CacheDBDefaultPrefix",this.read=async function(e,t){return(t=t||{}).type=t.type||(this.config.auto?"auto":"text"),new Promise(((r,i)=>{caches.open(this.namespace).then((i=>{i.match(new Request(`https://${this.prefix}/${encodeURIComponent(e)}`)).then((async e=>{if("auto"===t.type)switch(e.headers.get("Content-Type")){case"application/json":t.type="json";break;case"application/octet-stream":t.type="arrayBuffer";break;case"application/octet-stream":t.type="blob";break;case"text/number":t.type="number";break;case"text/boolean":t.type="boolean";break;default:t.type="text"}switch(t.type){case"number":return void r(Number(await e.text()));case"json":return void r(e.json());case"arrayBuffer":return void r(e.arrayBuffer());case"blob":return void r(e.blob());case"text":return void r(e.text());case"boolean":return void r(1==await e.text());default:return void r(e.body)}}))})).catch((e=>{console.error("CacheDB Read Erorr:"+e),i(null)}))}))},this.write=async function(e,t,r){var i;switch((r=r||{}).type=r.type||(this.config.auto?"auto":"text"),"auto"===r.type&&(r.type="object"==typeof(i=t)&&null!==i&&i.constructor===Object||Array.isArray(i)?"json":typeof t),r.type){case"json":r.content_type="application/json",t=JSON.stringify(t);break;case"arrayBuffer":case"blob":r.content_type="application/octet-stream";break;case"number":r.content_type="text/number",t=t.toString();break;case"boolean":r.content_type="text/boolean",t=t?1:0}return new Promise(((i,n)=>{caches.open(this.namespace).then((n=>{n.put(new Request(`https://${this.prefix}/${encodeURIComponent(e)}`),new Response(t,{headers:{"Content-Type":r.content_type}})).then(i(1))})).catch((e=>{console.error("CacheDB Write Erorr:"+e),n(0)}))}))},this.delete=async function(e){return new Promise(((t,r)=>{caches.open(this.namespace).then((r=>{r.delete(new Request(`https://${this.prefix}/${encodeURIComponent(e)}`)).then(t(!0))})).catch((e=>{console.error("CacheDB Delete Erorr:"+e),r(!1)}))}))},this.list=async function(){return new Promise(((e,t)=>{caches.open(this.namespace).then((t=>{t.keys().then((t=>{e(t.map((e=>decodeURIComponent(e.url.split("/").pop()))))}))})).catch((e=>{console.error("CacheDB List Erorr:"+e),t([])}))}))},this.all=async function(){const e={};return new Promise((async(t,r)=>{this.list().then((async r=>{await Promise.all(r.map((async t=>{e[t]=await this.read(t)}))),t(e)})).catch((e=>{console.error("CacheDB All Erorr:"+e),r([])}))}))},this.clear=async function(){return new Promise(((e,t)=>{this.list().then((t=>{t.forEach((e=>{this.delete(e)})),e(!0)})).catch((e=>{console.error("CacheDB Clear Erorr:"+e),t(!1)}))}))},this.destroy=async function(){return new Promise(((e,t)=>{this.clear().then((()=>{caches.delete(this.namespace).then(e(!0))})).catch((e=>{console.error("CacheDB Destroy Erorr:"+e),t(!1)}))}))}};const e={TarReader:class{constructor(){this.fileInfo=[]}readFile(e){return new Promise(((t,r)=>{let i=new FileReader;i.onload=e=>{this.buffer=e.target.result,this.fileInfo=[],this._readFileInfo(),t(this.fileInfo)},i.readAsArrayBuffer(e)}))}readArrayBuffer(e){return this.buffer=e,this.fileInfo=[],this._readFileInfo(),this.fileInfo}_readFileInfo(){this.fileInfo=[];let e=0,t=0,r="",i=null;for(;e<this.buffer.byteLength-512&&(r=this._readFileName(e),0!=r.length);)i=this._readFileType(e),t=this._readFileSize(e),this.fileInfo.push({name:r,type:i,size:t,header_offset:e}),e+=512+512*Math.trunc(t/512),t%512&&(e+=512)}getFileInfo(){return this.fileInfo}_readString(e,t){let r=new Uint8Array(this.buffer,e,t),i=r.indexOf(0);return(new TextDecoder).decode(r.slice(0,i))}_readFileName(e){return this._readString(e,100)}_readFileType(e){let t=new Uint8Array(this.buffer,e+156,1),r=String.fromCharCode(t[0]);return"0"==r?"file":"5"==r?"directory":r}_readFileSize(e){let t=new Uint8Array(this.buffer,e+124,12),r="";for(let e=0;e<11;e++)r+=String.fromCharCode(t[e]);return parseInt(r,8)}_readFileBlob(e,t,r){let i=new Uint8Array(this.buffer,e,t);return new Blob([i],{type:r})}_readFileBinary(e,t){return new Uint8Array(this.buffer,e,t)}_readTextFile(e,t){let r=new Uint8Array(this.buffer,e,t);return(new TextDecoder).decode(r)}getTextFile(e){let t=this.fileInfo.find((t=>t.name==e));if(t)return this._readTextFile(t.header_offset+512,t.size)}getFileBlob(e,t){let r=this.fileInfo.find((t=>t.name==e));if(r)return this._readFileBlob(r.header_offset+512,r.size,t)}getFileBinary(e){let t=this.fileInfo.find((t=>t.name==e));if(t)return this._readFileBinary(t.header_offset+512,t.size)}},TarWriter:class{constructor(){this.fileData=[]}addTextFile(e,t,r){let i=(new TextEncoder).encode(t);this.fileData.push({name:e,array:i,type:"file",size:i.length,dataType:"array",opts:r})}addFileArrayBuffer(e,t,r){let i=new Uint8Array(t);this.fileData.push({name:e,array:i,type:"file",size:i.length,dataType:"array",opts:r})}addFile(e,t,r){this.fileData.push({name:e,file:t,size:t.size,type:"file",dataType:"file",opts:r})}addFolder(e,t){this.fileData.push({name:e,type:"directory",size:0,dataType:"none",opts:t})}_createBuffer(){let e=0;for(let t=0;t<this.fileData.length;t++){let r=this.fileData[t].size;e+=512+512*Math.trunc(r/512),r%512&&(e+=512)}let t=10240*Math.trunc(e/10240);e%10240&&(t+=10240),this.buffer=new ArrayBuffer(t)}async download(e){let t=await this.writeBlob(),r=document.createElement("a");r.href=URL.createObjectURL(t),r.download=e,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}async writeBlob(e){return new Blob([await this.write(e)],{type:"application/x-tar"})}write(e){return new Promise(((t,r)=>{this._createBuffer();let i=0,n=0,a=()=>{if(n++,e&&e(n/this.fileData.length*100),n===this.fileData.length){let e=new Uint8Array(this.buffer);t(e)}};for(let e=0;e<this.fileData.length;e++){let t=this.fileData[e];this._writeFileName(t.name,i),this._writeFileType(t.type,i),this._writeFileSize(t.size,i),this._fillHeader(i,t.opts,t.type),this._writeChecksum(i);let r=new Uint8Array(this.buffer,i+512,t.size);if("array"===t.dataType){for(let e=0;e<t.size;e++)r[e]=t.array[e];a()}else if("file"===t.dataType){let e=new FileReader;e.onload=function(e){let t=e;return function(e){let r=e.target.result,i=new Uint8Array(r);for(let e=0;e<i.length;e++)t[e]=i[e];a()}}(r),e.readAsArrayBuffer(t.file)}else"directory"===t.type&&a();i+=512+512*Math.trunc(t.size/512),t.size%512&&(i+=512)}}))}_writeString(e,t,r){let i=new Uint8Array(this.buffer,t,r),n=new TextEncoder;if(n.encodeInto)for(let t=n.encodeInto(e,i).written;t<r;t++)i[t]=0;else{let t=n.encode(e);for(let e=0;e<r;e++)i[e]=e<t.length?t[e]:0}}_writeFileName(e,t){this._writeString(e,t,100)}_writeFileType(e,t){let r="0";"file"===e?r="0":"directory"===e&&(r="5"),new Uint8Array(this.buffer,t+156,1)[0]=r.charCodeAt(0)}_writeFileSize(e,t){let r=e.toString(8);r=this._leftPad(r,11),this._writeString(r,t+124,12)}_leftPad(e,t){let r=e+"";for(;r.length<t;)r="0"+r;return r}_writeFileMode(e,t){this._writeString(this._leftPad(e,7),t+100,8)}_writeFileUid(e,t){this._writeString(this._leftPad(e,7),t+108,8)}_writeFileGid(e,t){this._writeString(this._leftPad(e,7),t+116,8)}_writeFileMtime(e,t){this._writeString(this._leftPad(e,11),t+136,12)}_writeFileUser(e,t){this._writeString(e,t+265,32)}_writeFileGroup(e,t){this._writeString(e,t+297,32)}_writeChecksum(e){this._writeString("        ",e+148,8);let t=new Uint8Array(this.buffer,e,512),r=0;for(let e=0;e<512;e++)r+=t[e];this._writeString(r.toString(8),e+148,8)}_getOpt(e,t,r){return null!=e&&null!=e[t]?e[t]:r}_fillHeader(e,t,r){let i=this._getOpt(t,"uid",1e3),n=this._getOpt(t,"gid",1e3),a=this._getOpt(t,"mode","file"===r?"664":"775"),s=this._getOpt(t,"mtime",Date.now()),o=this._getOpt(t,"user","tarballjs"),c=this._getOpt(t,"group","tarballjs");this._writeFileMode(a,e),this._writeFileUid(i.toString(8),e),this._writeFileGid(n.toString(8),e),this._writeFileMtime(Math.trunc(s/1e3).toString(8),e),this._writeString("ustar",e+257,6),this._writeString("00",e+263,2),this._writeFileUser(o,e),this._writeFileGroup(c,e)}}},t=[{match:"(cdn|fastly)\\.jsdelivr\\.net",domain:"cdn.jsdelivr.net",concat:{npm:"/npm(/@{{PACKAGE_SCOPE}})?/({{PACKAGE_NAME}})(@{{PACKAGE_VERSION}})?(/{{$FILE_PATH}})?",github:"/gh/({{USER_NAME}})/({{REPO_NAME}})(@{{TAG_NAME}})?(/{{$FILE_PATH}})?"}},{match:"registry\\.npmmirror\\.com",domain:"registry.npmmirror.com",concat:{npm:"(/@{{PACKAGE_SCOPE}})?/({{PACKAGE_NAME}})(/{{PACKAGE_VERSION}})?/files(/{{$FILE_PATH}})?"},extra:{npm_meta:"(/@{{PACKAGE_SCOPE}})?/({{PACKAGE_NAME}})(/{{$PACKAGE_VERSION}})?",npm_registry:"(@{{PACKAGE_SCOPE}})?/({{PACKAGE_NAME}})/-/({{PACKAGE_NAME}})-({{PACKAGE_VERSION}}).tgz"}},{match:"registry\\.npmjs\\.org",domain:"registry.npmjs.org",concat:{},extra:{npm_meta:"(/@{{PACKAGE_SCOPE}})?/({{PACKAGE_NAME}})(/{{$PACKAGE_VERSION}})?",npm_registry:"(@{{PACKAGE_SCOPE}})?/({{PACKAGE_NAME}})/-/({{PACKAGE_NAME}})-({{PACKAGE_VERSION}}).tgz"}}],i=async e=>new Promise((async(t,r)=>{const i=new Event("abortOtherInstance"),n=new EventTarget,a=setTimeout((()=>{r(new Response("504 All GateWays Failed",{status:504,statusText:"504 All Gateways Timeout"}))}),5e3);await Promise.any(e.map((async e=>{"string"==typeof e&&(e=new Request(e));let r=new AbortController,s=!1;n.addEventListener(i.type,(()=>{s||r.abort()})),fetch(e,{signal:r.signal,mode:"cors",redirect:"follow"}).then((e=>{200===e.status&&(s=!0,n.dispatchEvent(i),clearTimeout(a),t(e.clone()))})).catch((e=>{"DOMException: The user aborted a request."==e&&console.log()}))}))).catch((e=>{r(e)}))}));self.CDNObject=function(r={}){this.config=Object.keys(r).length?r:{cdn:r.cdn?Object.assign({},t,r.cdn):t,cache:r.cache?r.cache:{LatestExpire:86400,UnuseExpire:2592e3}},this.CacheDB=e=>new CacheDB("CDNObject",e);const n=this,a=function(t){if(this.valid=!1,"string"!=typeof t&&"object"!=typeof t)throw new Error("Invalid URL");if(this.url=t,this.urlObject=new URL(t),this.id=n.config.cdn.findIndex((e=>new RegExp(e.match).test(t))),-1===this.id)throw new Error("CDN Not Found:"+t);for(var s in n.config.cdn[this.id].concat)if(this.matchRule=new RegExp(n.config.cdn[this.id].concat[s].replace(/\{\{\$(.*)\}\}/g,"(?<$1>.*)").replace(/\{\{(.*?)\}\}/g,"(?<$1>[^/@]+)").replace(/\//g,"\\/")),t.match(this.matchRule)){this.type=s;break}if(!this.type)throw new Error("CDN Prefix Not Found:"+t);if(this.domain=n.config.cdn[this.id].domain,this.var=t.match(this.matchRule).groups,this.valid=!0,this.genMirror=e=>{const t=n.config.cdn.findIndex((t=>t.domain===e));if(-1===t)throw new Error("CDN Mirror Not Found");if(!n.config.cdn[t].concat[this.type])throw new Error("This Mirror Has No Such Prefix: "+this.type+" ,It only has:"+Object.keys(n.config.cdn[t].concat).join(","));let r=`https://${n.config.cdn[t].domain}${n.config.cdn[t].concat[this.type]}`.replace(/\?/g,"");for(var i in this.var)r=r.replace(new RegExp(`\\(([^)]*)\\{\\{\\$?${i}\\}\\}([^(]*)\\)`,"g"),this.var[i]?`$1${this.var[i]}$2`:"");return new a(r)},this.getAllMirrors=()=>{const e=[];for(var t in n.config.cdn)n.config.cdn[t].concat[this.type]&&e.push({id:t,domain:n.config.cdn[t].domain,cdnObject:this.genMirror(n.config.cdn[t].domain),cdnUrl:this.genMirror(n.config.cdn[t].domain).url});return e},"npm"===this.type){if(this.getNewestVersion=async()=>{const e=["PACKAGE_SCOPE","PACKAGE_NAME"];let t=[];for(var r in n.config.cdn)if("object"==typeof n.config.cdn[r].extra&&n.config.cdn[r].extra.npm_meta){let i=`https://${n.config.cdn[r].domain}${n.config.cdn[r].extra.npm_meta}`;for(var a in this.var)i=i.replace(/\?/g,"").replace(new RegExp(`\\(([^)]*)\\{\\{\\$?${a}\\}\\}([^(]*)\\)`,"g"),-1!==e.indexOf(a)&&this.var[a]?`$1${this.var[a]}$2`:"");t.push(i)}return i(t).then((e=>e.json())).then((e=>e["dist-tags"].latest)).catch((e=>null))},"function"!=typeof r.ungzip)return void console.warn("CDNObject: ungzip function not found, pls import pako before inistantiating CDNObject,GetFileFromNPMPackageFunction will not work");const t=`${this.var.PACKAGE_SCOPE?"this.var.PACKAGE_SCOPE/":""}${this.var.PACKAGE_NAME}/${this.var.PACKAGE_VERSION}`;this.packageDownloaded=0,this.packageUntared=0,this.getPackage=async()=>{const e=n.CacheDB("npm_registry"),r=["PACKAGE_SCOPE","PACKAGE_NAME","PACKAGE_VERSION"];let a=[];for(var s in n.config.cdn)if("object"==typeof n.config.cdn[s].extra&&n.config.cdn[s].extra.npm_registry){let e=`https://${n.config.cdn[s].domain}${n.config.cdn[s].extra.npm_registry}`;for(var o in this.var)e=e.replace(/\?/g,"").replace(new RegExp(`\\(([^)]*)\\{\\{\\$?${o}\\}\\}([^(]*)\\)`,"g"),-1!==r.indexOf(o)&&this.var[o]?`$1${this.var[o]}$2`:"");a.push(e)}const c=await i(a).then((e=>e.arrayBuffer())).catch((e=>null));return await e.write(t,c,{type:"arrayBuffer"}),this.packageDownloaded=1,{CachePrefix:"npm_registry",CacheKey:t}},this.deletePackage=async()=>{if(!this.packageDownloaded)throw"need getPackage()";const e=n.CacheDB("npm_registry");return await e.delete(t),this.packageDownloaded=0,!0},this.untarPackage=async()=>{if(!this.packageDownloaded)throw"need getPackage()";const r=n.CacheDB("npm_registry"),i=n.CacheDB("npm"),a=await r.read(t,{type:"arrayBuffer"}),s=ungzip(new Uint8Array(a)),o=new Blob([s],{type:"application/octet-stream"});let c=new e.TarReader;return(await c.readFile(o)).forEach((async e=>{await i.write(`${t}/${e.name.replace(/^package\/?/g,"")}`,c.getFileBinary(e.name),{type:"arrayBuffer"})})),this.packageUntared=1,!0},this.getFileFromPackage=async()=>{if(!this.packageUntared)throw"need untarPackage()";if(!this.var.FILE_PATH)throw"need FILE_PATH";const e=n.CacheDB("npm"),r=`${t}/${this.var.FILE_PATH}`;return e.read(r,{type:"arrayBuffer"})}}};return a},new URL(self.location.href).host,self.cons={s:e=>{console.log(`%c[SUCCESS]%c ${e}`,"color:white;background:green;","")},w:e=>{console.log(`%c[WARNING]%c ${e}`,"color:brown;background:yellow;","")},i:e=>{console.log(`%c[INFO]%c ${e}`,"color:white;background:blue;","")},e:e=>{console.log(`%c[ERROR]%c ${e}`,"color:white;background:red;","")},d:e=>{console.log(`%c[DEBUG]%c ${e}`,"color:white;background:black;","")}},new CacheDB("CyanAcc","CyanAccDB"),addEventListener("fetch",(e=>{try{e.respondWith(fetch(e.request))}catch(t){return cons.e(`Fatal Error,CyanAcc Will Be disabled:${t}`),void e.respondWith(fetch(e.request))}})),addEventListener("install",(function(){self.skipWaiting()})),addEventListener("activate",(function(){try{self.clients.claim()}catch(e){console.log(e)}}))})()})();